<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.haier.m.dao.mshop.read.ProductsReadDao">
	<resultMap id="productsResult" type="com.haier.m.entity.item.Products">
		<result property="id" column="id" />
		<result property="productId" column="product_id" />
		<result property="productName" column="product_name" />
		<result property="productActivityInfo" column="product_activity_info" />
		<result property="productTitle" column="product_title" />
		<result property="brandId" column="brand_id" />
		<result property="productTypeId" column="product_type_id" />
		<result property="sellingPoint" column="selling_point" />
		<result property="productDetail" column="product_detail" />
		<result property="productBlockDetail" column="product_block_detail" />
		<result property="productCateId" column="product_cate_id" />
		<result property="productCatePath" column="product_cate_path" />
		<result property="onSale" column="on_sale" />
		<result property="isHot" column="is_hot" />
		<result property="isBest" column="is_best" />
		<result property="isNew" column="is_new" />
		<result property="isSpecial" column="is_special" />
		<result property="isDelete" column="is_delete" />
		<result property="supplyPrice" column="supply_price" />
		<result property="packagePrice" column="package_price" />
		<result property="saleGuidePrice" column="sale_guide_price" />
		<result property="rankPrice" column="rank_price" />
		<result property="sku" column="sku" />
		<result property="shippingMode" column="shipping_mode" />
		<result property="packageId" column="package_id" />
		<result property="isNotConfirm" column="is_not_confirm" />
		<result property="isNoLimitStockProduct" column="is_no_limit_stock_product" />
		<result property="productFullName" column="product_full_name" />
		<result property="defaultImageUrl" column="default_image_url" />
		<result property="indexImageUrl" column="index_image_url" />
		<result property="videoUrl" column="video_url" />
		<result property="productSource" column="product_source" />
		<result property="mobilePrice" column="mobile_price" />
		<result property="startTime" column="start_time" />
		<result property="endTime" column="end_time" />
		<result property="addTime" column="add_time" />
		<result property="addUser" column="add_user" />
		<result property="modifyTime" column="modify_time" />
		<result property="modifyUser" column="modify_user" />
	</resultMap>

	<select id="getItemById" parameterType="Integer" resultMap="productsResult">
		select * from `products`
		where `product_id` = #{id}
	</select>

	<select id="getRandomItemSKUByLimitNum" parameterType="Integer" resultType="String">
		SELECT sku 
		FROM products
		WHERE on_sale = 1
		ORDER BY RAND()
		LIMIT #{limitNum}
	</select>

	<select id="getItemBySKUs" resultMap="productsResult">
		SELECT * FROM products
		where sku in
		<foreach collection="skuList" index="index" item="item" open="(" separator="," close=")">
			#{item}
		</foreach>
	</select>
	<select id="getMshopItemForMiniStoreList" parameterType="java.util.Map" resultType="string">
		select sku from `products` t where on_sale=1
		<if test="skuList != null">
			and sku in
			<foreach collection="skuList" index="index" item="item" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
		<if test="keyword != null">
			and (t.`product_full_name` like
			concat('%',#{keyword},'%')
			or t.`product_name` like
			concat('%',#{keyword},'%')
			or t.`product_title` like
			concat('%',#{keyword},'%'))
		</if>
	</select>
	<select id="getItemBySKUsProductCateId" resultMap="productsResult">
		SELECT * FROM products t
		where on_sale=1 AND t.sku in
		<foreach collection="skuList" index="index" item="item" open="(" separator="," close=")">
			#{item}
		</foreach>
		<if test="productCateId != null">
			and
			t.product_cate_path like
			concat('%',#{productCateId},'%')
		</if>
	</select>

	<select id="getMShopItemBySku" resultMap="productsResult">
		SELECT * FROM products WHERE sku=#{sku} AND on_sale=1
	</select>

	<select id="getAllSkus" resultType="string">
		SELECT sku FROM Products WHERE on_sale=1
	</select>
</mapper>
