<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.haier.m.dao.shop.read.OrderProductReadDao">
    <resultMap id="orderProductResult" type="com.haier.m.entity.order.OrderProductInfo">
        <result property="id" column="id" />
        <result property="siteId" column="siteId" />
        <result property="isTest" column="isTest" />
        <result property="hasRead" column="hasRead" />
        <result property="supportOneDayLimit" column="supportOneDayLimit" />
        <result property="orderId" column="orderId" />
        <result property="cOrderSn" column="cOrderSn" />
        <result property="isBook" column="isBook" />
        <result property="cPaymentStatus" column="cPaymentStatus" />
        <result property="cPayTime" column="cPayTime" />
        <result property="productType" column="productType" />
        <result property="productId" column="productId" />
        <result property="productName" column="productName" />
        <result property="sku" column="sku" />
        <result property="price" column="price" />
        <result property="number" column="number" />
        <result property="lockedNumber" column="lockedNumber" />
        <result property="unlockedNumber" column="unlockedNumber" />
        <result property="productAmount" column="productAmount" />
        <result property="balanceAmount" column="balanceAmount" />
        <result property="couponAmount" column="couponAmount" />
        <result property="esAmount" column="esAmount" />
        <result property="giftCardNumberId" column="giftCardNumberId" />
        <result property="usedGiftCardAmount" column="usedGiftCardAmount" />
        <result property="couponLogId" column="couponLogId" />
        <result property="activityPrice" column="activityPrice" />
        <result property="activityId" column="activityId" />
        <result property="cateId" column="cateId" />
        <result property="brandId" column="brandId" />
        <result property="netPointId" column="netPointId" />
        <result property="shippingFee" column="shippingFee" />
        <result property="settlementStatus" column="settlementStatus" />
        <result property="receiptOrRejectTime" column="receiptOrRejectTime" />
        <result property="isWmsSku" column="isWmsSku" />
        <result property="sCode" column="sCode" />
        <result property="tsCode" column="tsCode" />
        <result property="tsShippingTime" column="tsShippingTime" />
        <result property="status" column="status" />
        <result property="productSn" column="productSn" />
        <result property="invoiceNumber" column="invoiceNumber" />
        <result property="expressName" column="expressName" />
        <result property="invoiceExpressNumber" column="invoiceExpressNumber" />
        <result property="postMan" column="postMan" />
        <result property="postManPhone" column="postManPhone" />
        <result property="isNotice" column="isNotice" />
        <result property="noticeType" column="noticeType" />
        <result property="noticeRemark" column="noticeRemark" />
        <result property="noticeTime" column="noticeTime" />
        <result property="shippingTime" column="shippingTime" />
        <result property="lessOrderSn" column="lessOrderSn" />
        <result property="waitGetLesShippingInfo" column="waitGetLesShippingInfo" />
        <result property="getLesShippingCount" column="getLesShippingCount" />
        <result property="outping" column="outping" />
        <result property="lessShipTime" column="lessShipTime" />
        <result property="closeTime" column="closeTime" />
        <result property="isReceipt" column="isReceipt" />
        <result property="isMakeReceipt" column="isMakeReceipt" />
        <result property="receiptNum" column="receiptNum" />
        <result property="receiptAddTime" column="receiptAddTime" />
        <result property="makeReceiptType" column="makeReceiptType" />
        <result property="shippingMode" column="shippingMode" />
        <result property="lastTimeForShippingMode" column="lastTimeForShippingMode" />
        <result property="lastEditorForShippingMode" column="lastEditorForShippingMode" />
        <result property="systemRemark" column="systemRemark" />
        <result property="tongshuaiWorkId" column="tongshuaiWorkId" />
        <result property="orderPromotionId" column="orderPromotionId" />
        <result property="orderPromotionAmount" column="orderPromotionAmount" />
        <result property="externalSaleSettingId" column="externalSaleSettingId" />
        <result property="recommendationId" column="recommendationId" />
        <result property="hasSendAlertNum" column="hasSendAlertNum" />
        <result property="isNoLimitStockProduct" column="isNoLimitStockProduct" />
        <result property="hpRegisterDate" column="hpRegisterDate" />
        <result property="hpFailDate" column="hpFailDate" />
        <result property="hpFinishDate" column="hpFinishDate" />
        <result property="hpReservationDate" column="hpReservationDate" />
        <result property="shippingOpporunity" column="shippingOpporunity" />
        <result property="isTimeoutFree" column="isTimeoutFree" />
        <result property="itemShareAmount" column="itemShareAmount" />
        <result property="lessShipTInTime" column="lessShipTInTime" />
        <result property="lessShipTOutTime" column="lessShipTOutTime" />
        <result property="cbsSecCode" column="cbsSecCode" />
        <result property="points" column="points" />
        <result property="modified" column="modified" />
        <result property="splitFlag" column="splitFlag" />
        <result property="splitRelateCOrderSn" column="splitRelateCOrderSn" />
        <result property="channelId" column="channelId" />
        <result property="activityId2" column="activityId2" />
        <result property="pdOrderStatus" column="pdOrderStatus" />
        <result property="storeId" column="storeId" />
        <result property="storeType" column="storeType" />
        <result property="stockType" column="stockType" />
        <result property="o2oType" column="o2oType" />
        <result property="brokerageType" column="brokerageType" />
    </resultMap>
    
    

    <select id="getOrderProductBycOrderSn" parameterType="String" resultMap="orderProductResult">
        SELECT *
        FROM OrderProducts o
        WHERE o.cOrderSn = #{cOrderSn}

    </select>
    
    <select id="getOrderProductsByOrderId" parameterType="int" resultMap="orderProductResult">
        SELECT *
        FROM OrderProducts o
        WHERE orderId = #{orderId}
    </select>
    
    <resultMap id="orderDetailResult" type="com.haier.m.entity.vo.OrderDetailVo">
        <result property="orderProductId" column="orderProductId" />
        <result property="cOrderSn" column="cOrderSn" />
        <result property="cPayTime" column="cPayTime" />
        <result property="stockType" column="stockType" />
        <result property="status" column="status" />
        <result property="o2oStoreId" column="storeId" />
        <result property="price" column="price" />
        <result property="number" column="number" />
        <result property="totalAmount" column="productAmount" />
        <result property="shippingFee" column="shippingFee" />
        <result property="itemShareAmount" column="itemShareAmount" />
        <result property="couponAmount" column="couponAmount" />
        <result property="couponCode" column="couponLogId" />
        <result property="orderPromotionAmount" column="orderPromotionAmount" />
        <result property="orderId" column="orderId" />
        <result property="addTime" column="addTime" />
        <result property="consignee" column="consignee" />
        <result property="regionName" column="regionName" />
        <result property="address" column="address" />
        <result property="mobile" column="mobile" />
        <result property="paymentStatus" column="paymentStatus" />
        <result property="orderStatus" column="orderStatus" />
        <result property="isBook" column="isBook" />
        <result property="isCod" column="isCod" />
        <result property="relationSn" column="relationSn" />
        <result property="orderSn" column="orderSn" />
        <result property="source" column="source" />
        <result property="memberId" column="memberId" />
        <result property="orderType" column="orderType" />
        <result property="orderRepaierId" column="orderRepaierId" />
        <result property="itemShareAmount" column="itemShareAmount" />
        <result property="orderPromotionAmount" column="orderPromotionAmount" />
        <result property="lessShipTime" column="lessShipTime" />
        <result property="closeTime" column="closeTime" />
        <result property="isTimeoutFree" column="isTimeoutFree" />
        <result property="cPayStatus" column="cPayStatus" />
        <result property="shippingMode" column="shippingMode" />
        <result property="isProduceDaily" column="isProduceDaily" />
        <result property="ckCode" column="ckCode" />
        <result property="productId" column="productId" />
        <result property="memberInvoiceId" column="memberInvoiceId" />
        <result property="orderRepairPaymentStatus" column="orderRepairPaymentStatus" />
    </resultMap>
    
    <select id="getOrderProductDetail" resultMap="orderDetailResult">
        SELECT 
        	ops.id as orderProductId, ops.cOrderSn, ops.stockType, ops.status, ops.storeId, ops.cPayTime, 
        	ops.price, ops.number, ops.productAmount, ops.shippingFee, ops.couponAmount, ops.couponLogId,
        	ops.itemShareAmount, ops.orderPromotionAmount, ops.lessShipTime, ops.closeTime, ops.isTimeoutFree,
        	ops.cPaymentStatus, ops.shippingMode, ops.productId,
        	o.addTime, o.consignee, o.regionName, o.address, o.mobile, o.orderStatus, o.id as orderId, o.paymentStatus,
        	o.isBook, o.isCod, o.relationOrderSn, o.orderSn, o.source, o.memberId, o.orderType, ors.id as orderRepaierId,
        	o.isProduceDaily, o.ckCode, o.memberInvoiceId, ors.paymentStatus orderRepairPaymentStatus
        FROM OrderProducts ops
        INNER JOIN Orders o on ops.orderId = o.id
        LEFT JOIN OrderRepairs ors on ors.orderProductId = ops.id
        <where>
        	<if test = 'cOrderSn != null'>
        		AND ops.cOrderSn = #{cOrderSn}
        	</if>
        	<if test = 'orderProductId != null'>
        		AND ops.id = #{orderProductId}
        	</if>
        </where>
        limit 1
    </select>
    
    <resultMap id="OpAttributeResult" type="com.haier.m.entity.order.OpAttribute">
		<result property="diamondCount" column="diamond_count" />
		<result property="diamondAmt" column="diamond_amt" />
		<result property="diamondCommiSettle" column="diamond_commi_settle" />
		<result property="diamondPaymentSettle" column="diamond_payment_settle" />
		<result property="diamondBilling" column="diamond_billing" />
		<result property="seashellCount" column="seashell_count" />
		<result property="seashellAmt" column="seashell_amt" />
		<result property="seashellCommiSettle" column="seashell_commi_settle" />
		<result property="seashellPaymentSettle" column="seashell_payment_settle" />
		<result property="seashellBilling" column="seashell_billing" />
		<result property="insuranceCount" column="insurance_count" />
		<result property="insuranceAmt" column="insurance_amt" />
		<result property="insuranceCommiSettle" column="insurance_commi_settle" />
		<result property="insurancePaymentSettle" column="insurance_payment_settle" />
		<result property="insuranceBilling" column="insurance_billing" />
		<result property="bankBenefit" column="bank_benefit" />
        <result property="attrPic" column="attr_pic" />
        <result property="attrName" column="attr_name" />
	</resultMap>
    
    <select id="getOpAttributeByOrderProductId" resultMap="OpAttributeResult">
    	select * from OrderProductsAttributes o  where  o.order_product_id  = #{orderProductId}
    </select>

</mapper>
