<?xml version="1.0" encoding="utf-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:context="http://www.springframework.org/schema/context"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo"
        xsi:schemaLocation="
            http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
            http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context-3.0.xsd
            http://code.alibabatech.com/schema/dubbo
            http://code.alibabatech.com/schema/dubbo/dubbo.xsd">     
    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="locations">
			<list>
				<value>classpath:jdbc.properties</value>
			</list>
		</property>
	</bean>
  
	<!-- bean config -->
    <import resource="classpath:datasources.xml" />
    
    <!-- anotation scan -->
	<context:component-scan base-package="com.haier.m.*"/>

	<bean id="shopReadSqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
		<property name="mapperLocations" value="classpath:sql-mapper/shop/read/*.xml" />
		<property name="dataSource" ref="shopReadDS" />
	</bean>
	<!-- -->
	<bean id="shoprWriteSqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
		<property name="mapperLocations" value="classpath:sql-mapper/shop/write/*.xml" />
		<property name="dataSource" ref="shopWriteDS" />
	</bean>
	
	<bean id="mShopReadSqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
		<property name="mapperLocations" value="classpath:sql-mapper/mshop/read/*.xml" />
		<property name="dataSource" ref="mShopReadDS" />
	</bean>
	
	<bean id="mShopWriteSqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
		<property name="mapperLocations" value="classpath:sql-mapper/mshop/write/*.xml" />
		<property name="dataSource" ref="mShopWriteDS" />
	</bean>
	
	<bean id="transactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
		<property name="dataSource" ref="shopWriteDS" />
	</bean>
	
	<bean id="transactionManagerMshop" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
		<property name="dataSource" ref="mShopWriteDS" />
	</bean>
    
    <import resource="classpath:mobile-item-service-config.xml" />
    
	<!-- dubbo config -->
    <dubbo:provider threadpool="cached" loadbalance="roundrobin" cluster="failfast" delay="-1" />
    <dubbo:protocol name="dubbo" port="${prop.dubbo.protocol.port}" />
    <dubbo:registry protocol="${prop.registry.protocol}" address="${prop.registry.address}" />
    
</beans>
